# Fine-Tuning Assistant

–í–∏–∑—É–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –¥–æ–æ–±—É—á–µ–Ω–∏—è —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º LoRA –∏ BitsAndBytes –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üé® **–í–∏–∑—É–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - —É–¥–æ–±–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ Gradio
- ü§ó **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ HuggingFace** - –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π –Ω–∞–ø—Ä—è–º—É—é —Å HuggingFace Hub
- üìä **–û—Ü–µ–Ω–∫–∞ –ø–∞–º—è—Ç–∏** - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ø–∞–º—è—Ç–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –æ–±—É—á–µ–Ω–∏—è
- üîß **–ö–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ 4-bit –∏ 8-bit –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ BitsAndBytes
- üõ°Ô∏è **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–∞–º—è—Ç–∏ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
- üìÅ **–§–æ—Ä–º–∞—Ç –¥–∞—Ç–∞—Å–µ—Ç–∞** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ JSONL —Ñ–æ—Ä–º–∞—Ç–∞ —Å –ø–æ–ª—è–º–∏ `instruction` –∏ `output`

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω CUDA –∏ PyTorch —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π GPU.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
python app.py
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:7860`

### –§–æ—Ä–º–∞—Ç –¥–∞—Ç–∞—Å–µ—Ç–∞

–î–∞—Ç–∞—Å–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSONL (JSON Lines), –≥–¥–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ - —ç—Ç–æ JSON –æ–±—ä–µ–∫—Ç:

```json
{"instruction": "–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è", "input": "", "output": "–û—Ç–≤–µ—Ç –º–æ–¥–µ–ª–∏"}
```

–ü—Ä–∏–º–µ—Ä:
```json
{"instruction": "–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–∞–ø–∏—Ç–∞–ª–∏–∑–º?", "input": "", "output": "–ö–∞–ø–∏—Ç–∞–ª–∏–∑–º - —ç—Ç–æ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞..."}
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è

- **–ú–æ–¥–µ–ª—å**: –ò–º—è –º–æ–¥–µ–ª–∏ —Å HuggingFace (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Qwen/Qwen2.5-7B-Instruct`) –∏–ª–∏ –ø—É—Ç—å –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏
- **–î–∞—Ç–∞—Å–µ—Ç**: –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSONL
- **–ö–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ**: –í—ã–±–µ—Ä–∏—Ç–µ 4-bit (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è), 8-bit –∏–ª–∏ –±–µ–∑ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏—è
- **Batch Size**: –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (–æ–±—ã—á–Ω–æ 1 –¥–ª—è –±–æ–ª—å—à–∏—Ö –º–æ–¥–µ–ª–µ–π)
- **Gradient Accumulation**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
- **LoRA –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**: Rank (r), Alpha, Dropout

### –û—Ü–µ–Ω–∫–∞ –ø–∞–º—è—Ç–∏

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "–û—Ü–µ–Ω–∫–∞ –ø–∞–º—è—Ç–∏" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ VRAM. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ü–µ–Ω–∏—Ç:
- –ü–∞–º—è—Ç—å –º–æ–¥–µ–ª–∏
- –ü–∞–º—è—Ç—å –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–π
- –ü–∞–º—è—Ç—å –¥–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
- –ü–∞–º—è—Ç—å –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞
- –û–±—â—É—é —Ç—Ä–µ–±—É–µ–º—É—é –ø–∞–º—è—Ç—å

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–∞–º—è—Ç–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –ø–∞–º—è—Ç–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- –£–º–µ–Ω—å—à–∏—Ç—å batch_size
- –£–≤–µ–ª–∏—á–∏—Ç—å gradient_accumulation_steps
- –£–º–µ–Ω—å—à–∏—Ç—å max_length
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `app.py` - –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å GUI
- `trainer_module.py` - –ú–æ–¥—É–ª—å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
- `memory_estimator.py` - –ú–æ–¥—É–ª—å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –ø–∞–º—è—Ç–∏
- `train.py` - –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è (—Å–æ—Ö—Ä–∞–Ω–µ–Ω –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
- `requirements.txt` - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ Qwen

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python app.py`
2. –í –ø–æ–ª–µ "–ò–º—è –º–æ–¥–µ–ª–∏" –≤–≤–µ–¥–∏—Ç–µ `Qwen/Qwen2.5-7B-Instruct`
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à –¥–∞—Ç–∞—Å–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSONL
4. –í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è
5. –ù–∞–∂–º–∏—Ç–µ "–û—Ü–µ–Ω–∏—Ç—å –ø–∞–º—è—Ç—å" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
6. –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ"

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏

–í–º–µ—Å—Ç–æ HuggingFace ID –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏:
```
./my-local-model
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.8+
- CUDA-—Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è GPU (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 8GB VRAM)
- PyTorch —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª—é–±—ã–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –±–∞–∑–µ Transformers, –≤–∫–ª—é—á–∞—è:
- Qwen/Qwen2.5
- Llama 2/3
- Mistral
- Phi
- –ò –¥—Ä—É–≥–∏–µ –º–æ–¥–µ–ª–∏ —Å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π Transformer

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
